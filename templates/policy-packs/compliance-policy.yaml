# Compliance Policy Pack Template
# This template provides regulatory compliance policies for GDPR, SOX, HIPAA,
# and other regulatory frameworks requiring audit trails and data governance.
#
# Usage:
# 1. Select applicable compliance standards
# 2. Configure audit and reporting requirements
# 3. Define retention and privacy policies
# 4. Load via PolicyPackManager

metadata:
  name: "compliance-policy-pack"
  version: "1.0.0"
  description: "Regulatory compliance policy pack for GDPR, SOX, HIPAA, and industry standards"
  author: "compliance-team"
  license: "MIT"
  tags:
    - "compliance"
    - "gdpr"
    - "sox"
    - "hipaa"
    - "audit"
    - "privacy"
  created: "2025-01-01T00:00:00Z"
  updated: "2025-01-01T00:00:00Z"

ontologies:
  - "http://www.w3.org/ns/prov#"                # Provenance
  - "http://www.w3.org/ns/dpv#"                 # Data Privacy Vocabulary
  - "http://purl.org/dc/terms/"                 # Dublin Core
  - "http://example.org/compliance#"            # Compliance ontology

config:
  enabled: true
  priority: 95                                   # High priority for compliance
  strictMode: true
  auditTrail: true
  receiptAnchor: "git-notes"
  cryptographicProof: true
  immutableAudit: true                           # Audit trail cannot be modified

# Compliance Hooks
hooks:
  # GDPR Compliance
  - path: "./hooks/gdpr-consent-validation.mjs"
    enabled: true
    priority: 100
    description: "Validates GDPR consent requirements"
    metadata:
      category: "gdpr"
      regulation: "GDPR Article 6, 7"
      severity: "critical"

  - path: "./hooks/gdpr-data-minimization.mjs"
    enabled: true
    priority: 99
    description: "Enforces GDPR data minimization principles"
    metadata:
      category: "gdpr"
      regulation: "GDPR Article 5(1)(c)"
      severity: "high"

  - path: "./hooks/gdpr-right-to-erasure.mjs"
    enabled: true
    priority: 98
    description: "Implements right to erasure (right to be forgotten)"
    metadata:
      category: "gdpr"
      regulation: "GDPR Article 17"
      severity: "high"

  # SOX Compliance
  - path: "./hooks/sox-financial-controls.mjs"
    enabled: true
    priority: 95
    description: "Enforces SOX financial data controls"
    metadata:
      category: "sox"
      regulation: "SOX Section 404"
      severity: "critical"

  - path: "./hooks/sox-audit-trail.mjs"
    enabled: true
    priority: 94
    description: "Creates SOX-compliant audit trail"
    metadata:
      category: "sox"
      regulation: "SOX Section 404"
      severity: "critical"

  - path: "./hooks/sox-change-control.mjs"
    enabled: true
    priority: 93
    description: "Enforces change control procedures"
    metadata:
      category: "sox"
      regulation: "SOX Section 404"
      severity: "high"

  # HIPAA Compliance
  - path: "./hooks/hipaa-phi-protection.mjs"
    enabled: true
    priority: 90
    description: "Protects Protected Health Information (PHI)"
    metadata:
      category: "hipaa"
      regulation: "HIPAA Privacy Rule"
      severity: "critical"

  - path: "./hooks/hipaa-access-logging.mjs"
    enabled: true
    priority: 89
    description: "Logs all PHI access for HIPAA compliance"
    metadata:
      category: "hipaa"
      regulation: "HIPAA Security Rule"
      severity: "critical"

  # Data Retention
  - path: "./hooks/retention-policy-enforcement.mjs"
    enabled: true
    priority: 85
    description: "Enforces regulatory data retention requirements"
    metadata:
      category: "retention"
      severity: "high"

  # Privacy and Consent
  - path: "./hooks/consent-management.mjs"
    enabled: true
    priority: 80
    description: "Manages consent for data processing"
    metadata:
      category: "privacy"
      severity: "high"

  # Audit and Reporting
  - path: "./hooks/compliance-audit-trail.mjs"
    enabled: true
    priority: 75
    description: "Creates comprehensive compliance audit trail"
    metadata:
      category: "audit"
      severity: "high"

# Compliance Frameworks
compliance:
  # GDPR (General Data Protection Regulation)
  gdpr:
    enabled: true
    scope: "eu-citizens"

    principles:
      - name: "Lawfulness, fairness and transparency"
        article: "Article 5(1)(a)"
        controls:
          - "Consent must be explicit and documented"
          - "Privacy notice must be clear and accessible"

      - name: "Purpose limitation"
        article: "Article 5(1)(b)"
        controls:
          - "Data use must match stated purpose"
          - "Purpose changes require new consent"

      - name: "Data minimization"
        article: "Article 5(1)(c)"
        controls:
          - "Collect only necessary data"
          - "Limit data retention periods"

      - name: "Accuracy"
        article: "Article 5(1)(d)"
        controls:
          - "Data must be accurate and up-to-date"
          - "Mechanisms for data correction"

      - name: "Storage limitation"
        article: "Article 5(1)(e)"
        controls:
          - "Define retention periods"
          - "Automatic deletion after retention period"

      - name: "Integrity and confidentiality"
        article: "Article 5(1)(f)"
        controls:
          - "Encryption of personal data"
          - "Access controls and authentication"

    dataSubjectRights:
      - "Right to access (Article 15)"
      - "Right to rectification (Article 16)"
      - "Right to erasure (Article 17)"
      - "Right to data portability (Article 20)"

    breachNotification:
      enabled: true
      timeLimit: 72                              # Hours to report breach
      authorities:
        - "data-protection-officer@example.org"

  # SOX (Sarbanes-Oxley Act)
  sox:
    enabled: true
    scope: "financial-data"

    sections:
      - name: "Section 302"
        description: "Corporate responsibility for financial reports"
        controls:
          - "CEO/CFO certification of financial statements"
          - "Internal controls assessment"

      - name: "Section 404"
        description: "Management assessment of internal controls"
        controls:
          - "Document internal control procedures"
          - "Annual assessment of control effectiveness"
          - "Audit trail for all financial transactions"

      - name: "Section 409"
        description: "Real-time disclosure of material changes"
        controls:
          - "Rapid disclosure of material changes"
          - "Real-time monitoring of financial data"

    financialControls:
      segregationOfDuties: true
      approvalWorkflows: true
      changeControl: true
      auditTrail: true

    auditRequirements:
      - "Complete audit trail for all financial data changes"
      - "Immutable audit records"
      - "Timestamp all transactions"
      - "Identify all actors (who did what)"

  # HIPAA (Health Insurance Portability and Accountability Act)
  hipaa:
    enabled: false                               # Enable if handling PHI
    scope: "protected-health-information"

    safeguards:
      administrative:
        - "Security management process"
        - "Workforce security"
        - "Information access management"
        - "Security awareness training"

      physical:
        - "Facility access controls"
        - "Workstation security"
        - "Device and media controls"

      technical:
        - "Access controls"
        - "Audit controls"
        - "Integrity controls"
        - "Transmission security"

    phi:
      encryption: true
      accessLogging: true
      minimalAccess: true
      retentionYears: 6

    breachNotification:
      enabled: true
      individualNotification: true
      hhsNotification: true                      # HHS Secretary notification
      mediaNotification: true                    # If >500 individuals affected
      timeLimit: 60                              # Days to notify

# Audit and Reporting
audit:
  # Audit Trail Requirements
  auditTrail:
    enabled: true
    immutable: true
    cryptographicProof: true

    capture:
      - "all data access events"
      - "all data modifications"
      - "all permission changes"
      - "all consent changes"
      - "all policy violations"

    fields:
      - "timestamp"
      - "actor (who)"
      - "action (what)"
      - "resource (which data)"
      - "outcome (success/failure)"
      - "ip_address"
      - "session_id"

    retention:
      gdpr: 3650                                 # 10 years (days)
      sox: 2555                                  # 7 years
      hipaa: 2190                                # 6 years
      default: 2555

  # Reporting
  reporting:
    enabled: true

    schedules:
      daily:
        - "compliance-violations-summary"
        - "consent-status-report"

      weekly:
        - "data-access-audit"
        - "retention-compliance-report"

      monthly:
        - "comprehensive-compliance-report"
        - "gdpr-compliance-metrics"
        - "sox-control-effectiveness"

      quarterly:
        - "regulatory-compliance-assessment"
        - "data-protection-impact-assessment"

    formats: ["json", "pdf", "html"]
    destination: "./reports/compliance"

    distribution:
      - role: "compliance-officer"
        reports: ["all"]
      - role: "data-protection-officer"
        reports: ["gdpr-*"]
      - role: "financial-controller"
        reports: ["sox-*"]

# Data Retention
retention:
  policies:
    - name: "Financial Records"
      retention: 2555                            # 7 years (SOX)
      category: "financial"

    - name: "Personal Data (GDPR)"
      retention: 1095                            # 3 years
      category: "personal-data"
      conditions:
        - "Active consent required"
        - "Delete upon consent withdrawal"

    - name: "Health Information (HIPAA)"
      retention: 2190                            # 6 years
      category: "phi"

    - name: "Audit Logs"
      retention: 3650                            # 10 years
      category: "audit"
      immutable: true

  automation:
    enabled: true
    checkInterval: 86400                         # Daily (seconds)
    notifyBeforeDeletion: 2592000                # 30 days notice

# Privacy and Consent
privacy:
  consentManagement:
    enabled: true
    granular: true                               # Per-purpose consent

    purposes:
      - "marketing"
      - "analytics"
      - "personalization"
      - "essential-services"

    tracking:
      - "consent given timestamp"
      - "consent withdrawn timestamp"
      - "consent version"
      - "consent method"

  dataSubjectRequests:
    enabled: true

    types:
      - type: "access"
        responseTime: 2592000                    # 30 days (seconds)
      - type: "rectification"
        responseTime: 2592000
      - type: "erasure"
        responseTime: 2592000
      - type: "portability"
        responseTime: 2592000

    workflow:
      - "Receive request"
      - "Verify identity"
      - "Process request"
      - "Notify completion"

# Dependencies
dependencies:
  - name: "governance-policy-pack"
    version: ">=1.0.0"
  - name: "security-policy-pack"
    version: ">=1.0.0"

# Environment Overrides
environments:
  development:
    compliance:
      gdpr:
        enabled: false
      sox:
        enabled: false

  staging:
    compliance:
      gdpr:
        enabled: true
      sox:
        enabled: true

  production:
    compliance:
      gdpr:
        enabled: true
      sox:
        enabled: true
      hipaa:
        enabled: true                            # If applicable

# Lifecycle Events
lifecycle:
  beforeLoad:
    - "npm run validate-compliance-controls"
    - "npm run check-regulatory-updates"

  afterLoad:
    - "npm run generate-compliance-report"
    - "npm run notify-compliance-officer"

# Resources
resources:
  schemas: "./schemas/compliance"
  policies: "./policies/compliance"
  shapes: "./shapes/compliance"
  documentation: "./docs/compliance"
  templates: "./templates/compliance"
  reports: "./reports/compliance"
