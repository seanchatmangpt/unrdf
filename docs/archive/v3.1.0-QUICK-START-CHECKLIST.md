# UNRDF v3.1.0 - Quick Start Checklist

**Sprint Start Date**: [TBD]
**Target Release**: [TBD + 20-33 days]
**Team Size**: 3-5 developers
**Validation Method**: OTEL span-based (no agent lies!)

---

## Pre-Implementation Checklist

### Day 0: Setup & Planning

- [ ] **Read full GOAP plan**: `docs/v3.1.0-GOAP-IMPLEMENTATION-PLAN.md`
- [ ] **Create GitHub project board**: "UNRDF v3.1.0 Release"
- [ ] **Create feature branches**:
  ```bash
  git checkout -b feature/isolated-vm-migration
  git checkout -b feature/browser-compatibility
  git checkout -b feature/otel-validation-v3.1
  ```
- [ ] **Assign team roles**:
  - [ ] Security Lead: _______________
  - [ ] Browser Lead: _______________
  - [ ] DevOps Lead: _______________
  - [ ] QA Lead: _______________
  - [ ] Tech Writer: _______________

- [ ] **Run baseline OTEL validation**:
  ```bash
  node validation/run-all.mjs comprehensive > baseline-score.txt
  # Record baseline score: _________/100
  ```

- [ ] **Set up local development**:
  ```bash
  pnpm install
  pnpm test  # Verify all tests pass
  pnpm build # Verify build succeeds
  ```

---

## Week 1: Security Foundation (Days 1-7)

### Priority 1: Core Sandbox Migration (Days 1-4)

**Owner**: Security Lead

- [ ] **Day 1-2: Copy isolated-vm implementation**
  - [ ] Read `/knowledge-engine/server/utils/secure-sandbox.mjs`
  - [ ] Create `/src/knowledge-engine/effect-sandbox-isolated.mjs`
  - [ ] Copy `createIsolate`, `registerEffect`, `executeEffect` methods
  - [ ] Test in isolation: `node test/security/isolated-vm-basic.test.mjs`

- [ ] **Day 2-3: Replace vm2 in effect-sandbox.mjs**
  - [ ] File: `/src/knowledge-engine/effect-sandbox.mjs`
  - [ ] Replace `_executeInVM2` method (lines 189-230)
  - [ ] Implement `_executeInIsolate` (currently throws error line 244)
  - [ ] Add feature flag: `UNRDF_SANDBOX_ENGINE=isolate`
  - [ ] Run tests: `pnpm test -- effect-sandbox`

- [ ] **Day 3: Update sandbox-adapter.mjs**
  - [ ] File: `/src/security/sandbox-adapter.mjs`
  - [ ] Replace vm2 import with isolated-vm
  - [ ] Maintain same API (no breaking changes)
  - [ ] Test: `pnpm test -- sandbox-adapter`

- [ ] **Day 4: Update schemas and dependencies**
  - [ ] File: `/src/knowledge-engine/schemas.mjs`
  - [ ] Change enum: `['worker', 'isolate']` (remove 'vm2')
  - [ ] Run: `pnpm add isolated-vm@^6.1.0`
  - [ ] Run: `pnpm remove vm2`
  - [ ] Verify build: `pnpm build`

**Checkpoint**: Run OTEL validation
```bash
node validation/run-all.mjs comprehensive
# Expected: Security score ≥ 85/100 (intermediate)
```

### Priority 2: Threat Detection (Days 3-5)

**Owner**: Security Lead

- [ ] **Day 3-4: Copy threat detector**
  - [ ] Read `/knowledge-engine/server/utils/sandbox-threat-detector.mjs`
  - [ ] Create `/src/security/threat-detector.mjs`
  - [ ] Remove h3 dependencies (knowledge-engine-specific)
  - [ ] Make standalone module

- [ ] **Day 4-5: Integrate with effect-sandbox**
  - [ ] Add `enableThreatDetection` config to schemas
  - [ ] Call threat detector before `_executeInIsolate`
  - [ ] Block if score ≥ 80
  - [ ] Add OTEL span: `security.threat.analyze`

**Checkpoint**: Test threat detection
```bash
node test/security/threat-detector.test.mjs
# Expected: All malicious code blocked
```

### Priority 3: Browser Polyfills (Days 1-3) - PARALLEL

**Owner**: Browser Lead

- [ ] **Day 1-2: Complete Worker polyfill**
  - [ ] File: `/src/knowledge-engine/browser-shims.mjs`
  - [ ] Fix BrowserWorker class (lines 134-206)
  - [ ] Test in Chrome DevTools
  - [ ] Test in Firefox DevTools

- [ ] **Day 2-3: Add Comunica browser adapter**
  - [ ] Install: `pnpm add @comunica/query-sparql-link-traversal`
  - [ ] Create `/src/knowledge-engine/comunica-browser.mjs`
  - [ ] Test SPARQL query in browser console

**Checkpoint**: Browser smoke test
```javascript
// Open browser console, run:
import { createBrowserKnowledgeHookManager } from './dist/unrdf.browser.js';
const manager = createBrowserKnowledgeHookManager();
console.log('Browser support:', manager ? '✅' : '❌');
```

---

## Week 2: Browser + Validation (Days 8-14)

### Priority 4: IndexedDB + Service Worker (Days 8-10)

**Owner**: Browser Lead

- [ ] **Day 8-9: IndexedDB RDF store**
  - [ ] Create `/src/knowledge-engine/indexeddb-store.mjs`
  - [ ] Implement quad storage
  - [ ] Add SPARQL query support
  - [ ] Test: Store 10K quads, query performance

- [ ] **Day 9-10: Service Worker**
  - [ ] Create `/src/knowledge-engine/service-worker.mjs`
  - [ ] Cache SPARQL queries
  - [ ] Test offline mode

**Checkpoint**: Browser storage test
```bash
npx playwright test test/browser/indexeddb.spec.mjs
# Expected: All storage operations succeed
```

### Priority 5: Browser Build Pipeline (Days 10-12)

**Owner**: Browser Lead + DevOps Lead

- [ ] **Day 10-11: esbuild configuration**
  - [ ] Create `build.browser.config.mjs`
  - [ ] Create `src/browser.mjs` (full bundle)
  - [ ] Create `src/browser-core.mjs` (minimal)
  - [ ] Run: `node build.browser.config.mjs`

- [ ] **Day 11-12: Package exports + CI**
  - [ ] Update `package.json` exports field
  - [ ] Add browser build to CI (`.github/workflows/ci.yml`)
  - [ ] Verify bundle size < 500KB

**Checkpoint**: Bundle validation
```bash
pnpm build
ls -lh dist/unrdf.browser.js  # Should be < 500KB
```

### Priority 6: OTEL Validation Updates (Days 12-14)

**Owner**: DevOps Lead

- [ ] **Day 12-13: New span definitions**
  - [ ] Create `src/validation/span-definitions-v3.1.mjs`
  - [ ] Define security spans
  - [ ] Define browser spans
  - [ ] Document in `docs/observability/OTEL-SPANS-v3.1.md`

- [ ] **Day 13-14: Validation suites**
  - [ ] Create `validation/security.validation.mjs`
  - [ ] Create `validation/browser.validation.mjs`
  - [ ] Update `validation/run-all.mjs`
  - [ ] Remove legacy CLI checks

**Checkpoint**: Validation framework test
```bash
node validation/run-all.mjs comprehensive
# Expected: Overall score ≥ 90/100
```

---

## Week 3: Testing + Documentation (Days 15-20)

### Priority 7: Security Testing (Days 15-17)

**Owner**: QA Lead + Security Lead

- [ ] **Day 15-16: VM escape tests**
  - [ ] Create `test/security/vm-escape.test.mjs`
  - [ ] Test all 13 threat patterns
  - [ ] Verify all blocked
  - [ ] Run: `pnpm test -- vm-escape`

- [ ] **Day 16-17: Integration tests**
  - [ ] Create `test/security/isolated-vm-integration.test.mjs`
  - [ ] Test effect registration + execution
  - [ ] Test resource limits
  - [ ] Test error handling

**Checkpoint**: Security validation
```bash
node validation/security.validation.mjs
# Expected: Security score ≥ 95/100
```

### Priority 8: Browser Testing (Days 15-17) - PARALLEL

**Owner**: QA Lead + Browser Lead

- [ ] **Day 15-16: Playwright setup**
  - [ ] Install: `pnpm add -D @playwright/test playwright`
  - [ ] Configure browsers: Chrome, Firefox, Safari
  - [ ] Create `test/browser/core-features.spec.mjs`

- [ ] **Day 16-17: Browser test suite**
  - [ ] Test RDF parsing
  - [ ] Test SPARQL queries
  - [ ] Test IndexedDB storage
  - [ ] Run: `npx playwright test`

**Checkpoint**: Browser validation
```bash
node validation/browser.validation.mjs
# Expected: Browser score ≥ 85/100
```

### Priority 9: Documentation (Days 18-20)

**Owner**: Tech Writer

- [ ] **Day 18: Migration guides**
  - [ ] Create `docs/migration/v3.0-to-v3.1-security.md`
  - [ ] Create `docs/guides/browser-usage.md`
  - [ ] Code examples tested

- [ ] **Day 19: API documentation**
  - [ ] Update JSDoc for all new APIs
  - [ ] Run: `npm run docs`
  - [ ] Verify no broken links

- [ ] **Day 20: Release notes**
  - [ ] Create `docs/releases/v3.1.0-RELEASE-NOTES.md`
  - [ ] Update `CHANGELOG.md`
  - [ ] Update `README.md` with v3.1 highlights

**Checkpoint**: Documentation review
- [ ] Peer review all docs
- [ ] Test all code examples
- [ ] Check for broken links

---

## Final Week: QA + Release (Days 21-23)

### Priority 10: Final Testing (Days 21-22)

**Owner**: QA Lead

- [ ] **Day 21: E2E tests**
  - [ ] Create `test/e2e/v3.1-features.test.mjs`
  - [ ] Test isolated-vm + threat detection flow
  - [ ] Test browser full stack
  - [ ] Run: `pnpm test:e2e`

- [ ] **Day 22: Manual QA**
  - [ ] Security review (VM escape attempts)
  - [ ] Browser testing (4+ browsers)
  - [ ] Mobile testing (iOS Safari, Chrome Android)
  - [ ] Performance regression check

**Checkpoint**: Final validation
```bash
node validation/run-all.mjs comprehensive
# Required: Overall score ≥ 90/100
```

### Priority 11: Release Preparation (Day 23)

**Owner**: All team

- [ ] **Morning: Final checks**
  - [ ] Run full test suite: `pnpm test`
  - [ ] Run OTEL validation: `node validation/run-all.mjs`
  - [ ] Check bundle sizes
  - [ ] Verify documentation complete

- [ ] **Afternoon: Release**
  - [ ] Update version: `package.json` → 3.1.0
  - [ ] Create git tag: `git tag v3.1.0`
  - [ ] Build release: `pnpm build`
  - [ ] Publish to npm: `npm publish`
  - [ ] Create GitHub release with notes
  - [ ] Announce release (Twitter, Discord, etc.)

**Final Checkpoint**: Post-release validation
```bash
# Install from npm
npm install unrdf@3.1.0
node -e "console.log(require('unrdf/package.json').version)"
# Expected: 3.1.0
```

---

## Daily Standup Template

**What I completed yesterday:**
- [ ] _________________________________

**What I'm working on today:**
- [ ] _________________________________

**Blockers/Issues:**
- [ ] _________________________________

**OTEL validation score today:**
- Security: ____/100
- Browser: ____/100
- Overall: ____/100

---

## Emergency Rollback Plan

If critical issues found:

1. **Revert feature flag**:
   ```bash
   export UNRDF_SANDBOX_ENGINE=worker
   ```

2. **Revert to vm2** (temporary):
   ```bash
   pnpm add vm2@3.9.0
   git revert <commit-hash>
   ```

3. **Hotfix release**:
   - Create `hotfix/v3.1.1` branch
   - Fix critical issue
   - Fast-track release

---

## Success Metrics Dashboard

Track daily:

| Metric | Baseline | Current | Target |
|--------|----------|---------|--------|
| OTEL Overall Score | ____/100 | ____/100 | ≥90/100 |
| Security Score | ____/100 | ____/100 | ≥95/100 |
| Browser Score | ____/100 | ____/100 | ≥85/100 |
| Test Coverage | 100% | ____% | 100% |
| Bundle Size (full) | - | ____KB | <500KB |
| Bundle Size (core) | - | ____KB | <200KB |
| VM Escape Tests | - | ____ blocked | 100% |
| Threat Detection | - | ____% accuracy | ≥95% |

---

## Quick Commands Reference

### Development
```bash
# Run tests
pnpm test

# Run tests with coverage
pnpm test -- --coverage

# Run specific test file
pnpm test -- effect-sandbox

# Watch mode
pnpm test:watch

# Build project
pnpm build

# Build browser bundles
node build.browser.config.mjs

# Lint
pnpm lint

# Format
pnpm format
```

### OTEL Validation
```bash
# Comprehensive validation
node validation/run-all.mjs comprehensive

# Individual suites
node validation/run-all.mjs individual

# Specific feature validation
node validation/security.validation.mjs
node validation/browser.validation.mjs
node validation/knowledge-engine.validation.mjs
```

### Browser Testing
```bash
# Install Playwright browsers
npx playwright install

# Run all browser tests
npx playwright test

# Run specific browser
npx playwright test --project=chromium
npx playwright test --project=firefox
npx playwright test --project=webkit

# Debug mode
npx playwright test --debug

# UI mode
npx playwright test --ui
```

### Dependencies
```bash
# Add dependency
pnpm add <package>

# Add dev dependency
pnpm add -D <package>

# Remove dependency
pnpm remove <package>

# Update dependencies
pnpm update

# Security audit
pnpm audit
pnpm audit --fix
```

---

## Communication Channels

- **Daily Standup**: [Time] on [Platform]
- **Sprint Planning**: [Day/Time] on [Platform]
- **Technical Discussions**: [Slack/Discord channel]
- **Documentation Reviews**: [PR comments]
- **OTEL Validation Results**: [Shared dashboard URL]

---

## Contact Information

| Role | Name | Contact |
|------|------|---------|
| Security Lead | _________ | _________ |
| Browser Lead | _________ | _________ |
| DevOps Lead | _________ | _________ |
| QA Lead | _________ | _________ |
| Tech Writer | _________ | _________ |
| Project Manager | _________ | _________ |

---

## Notes

**Important Reminders:**

1. **OTEL validation is the source of truth** - Never trust agent reports without validation
2. **Run validation frequently** - At least daily, preferably after each major change
3. **Document as you go** - Don't save documentation for the end
4. **Test in multiple browsers** - Don't assume cross-browser compatibility
5. **Keep backward compatibility** - Use feature flags for gradual rollout
6. **Security first** - Never compromise security for convenience

**GOLDEN RULE**: If OTEL validation score < target, work is NOT complete!

---

**Status**: READY TO START ✅
**Next Action**: Complete "Day 0: Setup & Planning" checklist above
