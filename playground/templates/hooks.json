{
  "templates": [
    {
      "id": "service-health-monitor",
      "name": "Service Health Monitor",
      "description": "Monitors service health based on error rates, latency, and throughput",
      "category": "Infrastructure",
      "tags": ["monitoring", "health", "services"],
      "icon": "üè•",
      "hook": {
        "id": "ex:ServiceHealthMonitor",
        "name": "Service Health Monitor",
        "description": "Monitors service error rates and latency",
        "select": "SELECT ?service ?errorRate ?latency ?requests WHERE { ?service <http://example.org/errorRate> ?errorRate ; <http://example.org/latency> ?latency ; <http://example.org/requests> ?requests }",
        "predicates": [
          {
            "kind": "THRESHOLD",
            "spec": {
              "var": "errorRate",
              "op": ">",
              "value": 0.02
            }
          },
          {
            "kind": "HEALTH_SCORE",
            "spec": {
              "threshold": 70
            }
          }
        ],
        "combine": "OR",
        "output": {
          "format": "jsonld",
          "destination": "webhook",
          "schema": {
            "type": "object",
            "properties": {
              "service": { "type": "string" },
              "alert": { "type": "string" },
              "severity": { "type": "string" },
              "timestamp": { "type": "string" }
            }
          }
        }
      },
      "sampleData": "@prefix ex: <http://example.org/> .\n\nex:service1 a ex:Service ;\n  ex:errorRate 0.05 ;\n  ex:latency 1500 ;\n  ex:requests 1000 .\n\nex:service2 a ex:Service ;\n  ex:errorRate 0.01 ;\n  ex:latency 300 ;\n  ex:requests 2000 ."
    },
    {
      "id": "compliance-validator",
      "name": "GDPR Compliance Validator",
      "description": "Validates data processing compliance with GDPR requirements",
      "category": "Compliance",
      "tags": ["gdpr", "compliance", "validation", "privacy"],
      "icon": "üîí",
      "hook": {
        "id": "ex:GDPRComplianceGate",
        "name": "GDPR Compliance Gate",
        "description": "Ensures all sensitive data processing complies with GDPR",
        "select": "SELECT ?resource ?sensitive WHERE { ?resource <http://example.org/sensitive> ?sensitive }",
        "predicates": [
          {
            "kind": "SHACL",
            "spec": {
              "shape": "ex:GDPRShape",
              "strict": true
            }
          },
          {
            "kind": "ASK",
            "spec": {
              "query": "ASK WHERE { ?resource <http://example.org/consentGiven> false }",
              "expected": false
            }
          }
        ],
        "combine": "AND",
        "output": {
          "format": "jsonld",
          "destination": "webhook",
          "schema": {
            "type": "object",
            "properties": {
              "violation": { "type": "string" },
              "resource": { "type": "string" },
              "severity": { "type": "string" },
              "regulation": { "type": "string" }
            }
          }
        }
      },
      "sampleData": "@prefix ex: <http://example.org/> .\n@prefix gdpr: <http://example.org/gdpr/> .\n\nex:personalData a ex:SensitiveData ;\n  ex:sensitive true ;\n  ex:consentGiven true ;\n  ex:processingPurpose \"marketing\" .\n\nex:medicalRecord a ex:SensitiveData ;\n  ex:sensitive true ;\n  ex:consentGiven false ;\n  ex:processingPurpose \"research\" ."
    },
    {
      "id": "infrastructure-monitor",
      "name": "Infrastructure Monitor",
      "description": "Monitors server resources, disk usage, and system performance",
      "category": "Infrastructure",
      "tags": ["infrastructure", "monitoring", "servers", "resources"],
      "icon": "üñ•Ô∏è",
      "hook": {
        "id": "ex:InfrastructureMonitor",
        "name": "Infrastructure Monitor",
        "description": "Monitors server resources and system performance",
        "select": "SELECT ?server ?cpuUsage ?memoryUsage ?diskUsage WHERE { ?server <http://example.org/cpuUsage> ?cpuUsage ; <http://example.org/memoryUsage> ?memoryUsage ; <http://example.org/diskUsage> ?diskUsage }",
        "predicates": [
          {
            "kind": "THRESHOLD",
            "spec": {
              "var": "cpuUsage",
              "op": ">",
              "value": 80
            }
          },
          {
            "kind": "THRESHOLD",
            "spec": {
              "var": "memoryUsage",
              "op": ">",
              "value": 85
            }
          },
          {
            "kind": "THRESHOLD",
            "spec": {
              "var": "diskUsage",
              "op": ">",
              "value": 90
            }
          }
        ],
        "combine": "OR",
        "output": {
          "format": "jsonld",
          "destination": "webhook",
          "schema": {
            "type": "object",
            "properties": {
              "server": { "type": "string" },
              "metric": { "type": "string" },
              "value": { "type": "number" },
              "threshold": { "type": "number" },
              "severity": { "type": "string" }
            }
          }
        }
      },
      "sampleData": "@prefix ex: <http://example.org/> .\n\nex:server1 a ex:Server ;\n  ex:cpuUsage 75 ;\n  ex:memoryUsage 82 ;\n  ex:diskUsage 45 .\n\nex:server2 a ex:Server ;\n  ex:cpuUsage 92 ;\n  ex:memoryUsage 78 ;\n  ex:diskUsage 88 ."
    },
    {
      "id": "business-kpi-tracker",
      "name": "Business KPI Tracker",
      "description": "Tracks key business metrics like revenue, user engagement, and conversion rates",
      "category": "Business",
      "tags": ["business", "kpi", "metrics", "revenue", "engagement"],
      "icon": "üìä",
      "hook": {
        "id": "ex:BusinessKPIs",
        "name": "Business KPI Monitor",
        "description": "Tracks critical business metrics and thresholds",
        "select": "SELECT ?metric ?value ?target WHERE { ?metric <http://example.org/value> ?value ; <http://example.org/target> ?target }",
        "predicates": [
          {
            "kind": "THRESHOLD",
            "spec": {
              "var": "value",
              "op": "<",
              "value": 0.8,
              "aggregate": "avg"
            }
          },
          {
            "kind": "COUNT",
            "spec": {
              "op": "<",
              "value": 10
            }
          }
        ],
        "combine": "OR",
        "output": {
          "format": "jsonld",
          "destination": "webhook",
          "schema": {
            "type": "object",
            "properties": {
              "metric": { "type": "string" },
              "current": { "type": "number" },
              "target": { "type": "number" },
              "status": { "type": "string" },
              "trend": { "type": "string" }
            }
          }
        }
      },
      "sampleData": "@prefix ex: <http://example.org/> .\n\nex:revenue a ex:KPI ;\n  ex:value 0.95 ;\n  ex:target 1.0 .\n\nex:userEngagement a ex:KPI ;\n  ex:value 0.78 ;\n  ex:target 0.85 .\n\nex:conversionRate a ex:KPI ;\n  ex:value 0.032 ;\n  ex:target 0.050 ."
    },
    {
      "id": "security-monitor",
      "name": "Security Monitor",
      "description": "Monitors security events, authentication failures, and threat patterns",
      "category": "Security",
      "tags": ["security", "threats", "authentication", "monitoring"],
      "icon": "üõ°Ô∏è",
      "hook": {
        "id": "ex:SecurityMonitor",
        "name": "Security Event Monitor",
        "description": "Detects security threats and authentication anomalies",
        "select": "SELECT ?event ?type ?severity ?count WHERE { ?event <http://example.org/eventType> ?type ; <http://example.org/severity> ?severity ; <http://example.org/count> ?count }",
        "predicates": [
          {
            "kind": "THRESHOLD",
            "spec": {
              "var": "count",
              "op": ">",
              "value": 100
            }
          },
          {
            "kind": "THRESHOLD",
            "spec": {
              "var": "severity",
              "op": ">=",
              "value": 7
            }
          }
        ],
        "combine": "OR",
        "output": {
          "format": "jsonld",
          "destination": "webhook",
          "schema": {
            "type": "object",
            "properties": {
              "eventType": { "type": "string" },
              "severity": { "type": "number" },
              "count": { "type": "number" },
              "action": { "type": "string" },
              "timestamp": { "type": "string" }
            }
          }
        }
      },
      "sampleData": "@prefix ex: <http://example.org/> .\n\nex:failedLogin a ex:SecurityEvent ;\n  ex:eventType \"authentication_failure\" ;\n  ex:severity 8 ;\n  ex:count 150 .\n\nex:unusualAccess a ex:SecurityEvent ;\n  ex:eventType \"suspicious_access\" ;\n  ex:severity 6 ;\n  ex:count 45 ."
    },
    {
      "id": "data-quality-monitor",
      "name": "Data Quality Monitor",
      "description": "Monitors data completeness, accuracy, and schema compliance",
      "category": "Data Quality",
      "tags": ["quality", "validation", "completeness", "schema"],
      "icon": "‚úÖ",
      "hook": {
        "id": "ex:DataQualityMonitor",
        "name": "Data Quality Monitor",
        "description": "Validates data quality and schema compliance",
        "select": "SELECT ?dataset ?completeness ?accuracy ?validity WHERE { ?dataset <http://example.org/completeness> ?completeness ; <http://example.org/accuracy> ?accuracy ; <http://example.org/validity> ?validity }",
        "predicates": [
          {
            "kind": "THRESHOLD",
            "spec": {
              "var": "completeness",
              "op": "<",
              "value": 0.9
            }
          },
          {
            "kind": "THRESHOLD",
            "spec": {
              "var": "accuracy",
              "op": "<",
              "value": 0.95
            }
          }
        ],
        "combine": "OR",
        "output": {
          "format": "jsonld",
          "destination": "webhook",
          "schema": {
            "type": "object",
            "properties": {
              "dataset": { "type": "string" },
              "qualityMetric": { "type": "string" },
              "current": { "type": "number" },
              "threshold": { "type": "number" },
              "actionRequired": { "type": "string" }
            }
          }
        }
      },
      "sampleData": "@prefix ex: <http://example.org/> .\n\nex:customerData a ex:Dataset ;\n  ex:completeness 0.95 ;\n  ex:accuracy 0.98 ;\n  ex:validity 0.99 .\n\nex:productCatalog a ex:Dataset ;\n  ex:completeness 0.87 ;\n  ex:accuracy 0.92 ;\n  ex:validity 0.96 ."
    }
  ],
  "categories": [
    {
      "id": "infrastructure",
      "name": "Infrastructure",
      "description": "Monitor servers, services, and system resources"
    },
    {
      "id": "compliance",
      "name": "Compliance",
      "description": "Ensure regulatory compliance and audit requirements"
    },
    {
      "id": "business",
      "name": "Business",
      "description": "Track business metrics and KPI performance"
    },
    {
      "id": "security",
      "name": "Security",
      "description": "Monitor security events and threat detection"
    },
    {
      "id": "data-quality",
      "name": "Data Quality",
      "description": "Validate data completeness, accuracy, and schema compliance"
    }
  ],
  "version": "1.0.0",
  "description": "Pre-built Knowledge Hook templates for common enterprise use cases"
}
