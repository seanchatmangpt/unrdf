graph TD
    subgraph "Before vs After: Specific Composable Examples"
        subgraph "useCanon() - BEFORE (❌ Problematic)"
            CanonBefore["useCanon() - Current Implementation"]
            CanonBeforeEngine["const engine = new RdfEngine()<br/>❌ Creates isolated engine"]
            CanonBeforeStore["const store = new Store()<br/>❌ Creates isolated store"]
            CanonBeforeOps["canonicalize(store)<br/>❌ Works on isolated data"]
        end
        
        subgraph "useCanon() - AFTER (✅ Correct)"
            CanonAfter["useCanon() - Refactored Implementation"]
            CanonAfterContext["const storeContext = useStoreContext()<br/>✅ Uses shared context"]
            CanonAfterEngine["const engine = storeContext.engine<br/>✅ Uses shared engine"]
            CanonAfterOps["canonicalize(storeContext.store)<br/>✅ Works on shared data"]
        end
        
        subgraph "useTurtleFS() - BEFORE (❌ Problematic)"
            TurtleFSBefore["useTurtleFS() - Current Implementation"]
            TurtleFSBeforeCall["const store = useStore()<br/>❌ Calls useStore() in async function"]
            TurtleFSBeforeIssue["Potential context loss<br/>❌ Async context issues"]
        end
        
        subgraph "useTurtleFS() - AFTER (✅ Correct)"
            TurtleFSAfter["useTurtleFS() - Refactored Implementation"]
            TurtleFSAfterContext["const storeContext = useStoreContext()<br/>✅ Direct context access"]
            TurtleFSAfterStore["const store = storeContext.store<br/>✅ Uses context store"]
        end
        
        subgraph "useJsonLD() - REMOVED (❌ Complete Violation)"
            JsonLDRemove["useJsonLD() - REMOVE ENTIRELY"]
            JsonLDViolation["const engine = new RdfEngine()<br/>❌ Complete context violation"]
            JsonLDIsolation["Isolated engine and store<br/>❌ Breaks One Store Rule"]
        end
    end
    
    CanonBefore --> CanonBeforeEngine
    CanonBeforeEngine --> CanonBeforeStore
    CanonBeforeStore --> CanonBeforeOps
    
    CanonAfter --> CanonAfterContext
    CanonAfterContext --> CanonAfterEngine
    CanonAfterEngine --> CanonAfterOps
    
    TurtleFSBefore --> TurtleFSBeforeCall
    TurtleFSBeforeCall --> TurtleFSBeforeIssue
    
    TurtleFSAfter --> TurtleFSAfterContext
    TurtleFSAfterContext --> TurtleFSAfterStore
    
    JsonLDRemove --> JsonLDViolation
    JsonLDViolation --> JsonLDIsolation
    
    classDef before fill:#ffebee,stroke:#c62828,stroke-width:2px
    classDef after fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
    classDef remove fill:#fce4ec,stroke:#880e4f,stroke-width:3px
    
    class CanonBefore,CanonBeforeEngine,CanonBeforeStore,CanonBeforeOps,TurtleFSBefore,TurtleFSBeforeCall,TurtleFSBeforeIssue before
    class CanonAfter,CanonAfterContext,CanonAfterEngine,CanonAfterOps,TurtleFSAfter,TurtleFSAfterContext,TurtleFSAfterStore after
    class JsonLDRemove,JsonLDViolation,JsonLDIsolation remove
