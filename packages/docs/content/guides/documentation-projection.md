# How to Generate Documentation

This guide explains how to use the documentation projection system to generate deterministic documentation from your codebase.

`intermediate` `documentation` `projection`

---

## Prerequisites

- Node.js 18+
- UNRDF installed
- Source files with JSDoc comments
- Test files for examples

---

## Steps

### Step 1: Install the Projection Module

Add the projection module to your project:

```javascript
// The projection module is included in @unrdf/projection
import { ProjectionPipeline } from '@unrdf/projection';
```

### Step 2: Prepare Your Sources

Organize your source files with proper JSDoc comments:

```javascript
/**
 * Add two numbers
 *
 * @param {number} a - First number
 * @param {number} b - Second number
 * @returns {number} Sum of a and b
 *
 * @example
 * add(1, 2) // => 3
 */
export function add(a, b) {
  return a + b;
}
```

### Step 3: Create the Pipeline

Initialize a projection pipeline with your project configuration:

```javascript
const pipeline = new ProjectionPipeline({
  projectName: 'MyProject',
  version: '1.0.0',
  description: 'My project description',
  audiences: ['user', 'contributor'],
});
```

### Step 4: Run the Pipeline

Execute the projection with your sources:

```javascript
import { readFileSync } from 'fs';

const result = await pipeline.run({
  sources: [
    {
      name: 'mymodule.mjs',
      content: readFileSync('src/mymodule.mjs', 'utf-8'),
      type: 'source',
    },
    {
      name: 'mymodule.test.mjs',
      content: readFileSync('tests/mymodule.test.mjs', 'utf-8'),
      type: 'test',
    },
  ],
  receipts: [], // Governance receipts if any
});
```

### Step 5: Verify Determinism

Ensure the output is deterministic:

```javascript
// Run twice and compare hashes
const result1 = await pipeline.run(input);
const result2 = await pipeline.run(input);

console.log(result1.outputHash === result2.outputHash); // true
```

### Step 6: Access Generated Documentation

The result contains all generated documentation:

```javascript
// Main index
console.log(result.diataxis.mainIndex);

// API reference (from JSDoc)
console.log(result.projections.jsdoc.modules[0].markdown);

// Examples (from tests)
console.log(result.projections.examples.files[0].markdown);

// By Diataxis quadrant
console.log(result.diataxis.quadrants.reference.documents);
console.log(result.diataxis.quadrants.tutorial.documents);
```

### Step 7: Save Documentation

Write the documentation to files:

```javascript
import { writeFileSync, mkdirSync } from 'fs';

// Create output directory
mkdirSync('docs/api', { recursive: true });

// Write main index
writeFileSync('docs/index.md', result.diataxis.mainIndex);

// Write API docs
for (const module of result.projections.jsdoc.modules) {
  writeFileSync(`docs/api/${module.moduleName}.md`, module.markdown);
}

// Write examples
for (const file of result.projections.examples.files) {
  const name = file.fileName.replace('.test.mjs', '-examples.md');
  writeFileSync(`docs/tutorials/${name}`, file.markdown);
}
```

---

## Quick Reference

### Individual Projectors

For simpler use cases, use individual projectors:

```javascript
import { JsDocProjector, ExampleProjector } from '@unrdf/projection';

// Just API docs
const jsDocProjector = new JsDocProjector();
const apiResult = await jsDocProjector.project(sourceCode, 'my-module');

// Just examples
const exampleProjector = new ExampleProjector();
const exampleResult = await exampleProjector.project(testCode, 'my.test.mjs');
```

### Helper Functions

```javascript
import { projectApiDoc, projectExamples, projectChangelog } from '@unrdf/projection';

// Quick API doc generation
const { markdown, hash } = await projectApiDoc(source, 'module-name');

// Quick example generation
const examples = await projectExamples(testContent, 'test.mjs');

// Quick changelog generation
const changelog = await projectChangelog(receipts, { projectName: 'MyProject' });
```

---

## Related Guides

- [Creating Custom Partitions](guide-create-partition.md)
- [Generating Governance Receipts](guide-create-receipt.md)
- [Querying Across Partitions](guide-query-universe.md)

---

*Generated by @unrdf/projection*
